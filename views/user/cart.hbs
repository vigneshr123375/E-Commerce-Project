<style>
	.cart-wrap {
		padding: 40px 0;

	}

	.main-heading {
		font-size: 19px;
		margin-bottom: 20px;
	}

	.table-cart table {
		width: 100%;
	}

	.table-cart thead {
		border-bottom: 1px solid #e5e5e5;
		margin-bottom: 5px;
	}

	.table-cart thead tr th {
		padding: 8px 0 18px;
		color: #484848;
		font-size: 15px;
		font-weight: 400;
	}

	.table-cart tr td {
		padding: 40px 0 27px;
		vertical-align: middle;
	}

	.table-cart tr td:nth-child(1) {
		width: 52%;
	}

	.table-cart tr td:nth-child(2) {
		width: 26%;
	}

	.table-cart tr td:nth-child(3) {
		width: 13.333%;
	}

	.table-cart tr td:nth-child(4) {
		width: 8.667%;
		text-align: right;
	}

	.table-cart tr td .img-product {
		width: 72px;
		float: left;
		margin-left: 8px;
		margin-right: 31px;
		line-height: 63px;
	}

	.table-cart tr td .img-product img {
		width: 100%;
	}

	.table-cart tr td .name-product {
		font-size: 15px;
		color: #484848;
		padding-top: 8px;
		line-height: 24px;
		width: 50%;
	}

	.table-cart tr td .price {
		text-align: right;
		line-height: 64px;
		margin-right: 40px;
		color: #989898;
		font-size: 16px;
		font-family: 'Nunito';
	}

	.table-cart tr td .quanlity {
		position: relative;
	}

	.product-count .qtyminus,
	.product-count .qtyplus {
		width: 34px;
		height: 34px;
		background: transparent;
		text-align: center;
		font-size: 19px;
		line-height: 34px;
		color: #000;
		cursor: pointer;
		font-weight: 600;
	}

	.product-count .qtyminus {
		line-height: 32px;
	}

	.product-count .qtyminus {
		border-radius: 3px 0 0 3px;
	}

	.product-count .qtyplus {
		border-radius: 0 3px 3px 0;
	}

	.product-count .qty {
		width: 60px;
		text-align: center;
		border: none;
	}

	.count-inlineflex {
		display: inline-flex;
		border: solid 2px #ccc;
		border-radius: 20px;
	}

	.total {
		font-size: 24px;
		font-weight: 600;
		color: #7289ab;
	}

	.display-flex {
		display: flex;
	}

	.align-center {
		align-items: center;
	}

	.coupon-box {
		padding: 63px 0 58px;
		text-align: center;
		border: 2px dotted #e5e5e5;
		border-radius: 10px;
		margin-top: 55px;
	}

	.coupon-box form input {
		display: inline-block;
		width: 264px;
		margin-right: 13px;
		height: 44px;
		border-radius: 25px;
		border: solid 2px #cccccc;
		padding: 5px 15px;
		font-size: 14px;
	}

	input:focus {
		outline: none;
		box-shadow: none;
	}

	.round-black-btn {
		border-radius: 25px;
		background: #212529;
		color: #fff;
		padding: 8px 35px;
		display: inline-block;
		border: solid 2px #212529;
		transition: all 0.5s ease-in-out 0s;
		cursor: pointer;
	}

	.round-black-btn:hover,
	.round-black-btn:focus {
		background: transparent;
		color: #212529;
		text-decoration: none;
	}

	.cart-totals {
		border-radius: 3px;
		background: #e7e7e7;
		padding: 25px;
	}

	.cart-totals h3 {
		font-size: 19px;
		color: #3c3c3c;
		letter-spacing: 1px;
		font-weight: 500;
	}

	.cart-totals table {
		width: 100%;
	}

	.cart-totals table tr th,
	.cart-totals table tr td {
		width: 50%;
		padding: 3px 0;
		vertical-align: middle;
	}

	.cart-totals table tr td:last-child {
		text-align: right;
	}

	.cart-totals table tr td.subtotal {
		font-size: 20px;
		color: #6f6f6f;
	}

	.cart-totals table tr td.free-shipping {
		font-size: 14px;
		color: #6f6f6f;
	}

	.cart-totals table tr.total-row td {
		padding-top: 25px;
	}

	.cart-totals table tr td.price-total {
		font-size: 24px;
		font-weight: 600;
		color: #7289ab;
	}

	.btn-cart-totals {
		text-align: center;
		margin-top: 60px;
		margin-bottom: 20px;
	}

	.btn-cart-totals .round-black-btn {
		margin: 10px 0;
	}
</style>
<div class="cart-wrap">
	<div class="container">
		<div class="row">
			<div class="col-lg-8">
				<div class="main-heading">Shopping Cart</div>
				<div class="table-cart">
					<table>
						<thead>
							<tr>
								<th>Product</th>
								<th>Quantity</th>
								<th>Remove</th>
								<th></th>
							</tr>
						</thead>
						<tbody>

							{{#each products}}

							<tr>
								<td>

									<div class="display-flex align-center">
										<div class="img-product">
											<img src="/product-images/{{this.product._id}}.jpg" alt=""
												class="mCS_img_loaded">
										</div>
										<div class="name-product">
											{{this.product.Name}}
										</div>
										<div class="price">
											&#8377;{{this.product.Price}}
										</div>
									</div>
								</td>


								<td class="product-count">
									<form class="count-inlineflex">

										
										<button id="minus-count" style="border: none;" class="qtyplus text-danger"
											onclick="changeQuantity('{{this._id}}','{{this.product._id}}','{{../user}}',-1)">-</button>
										
										<span style="padding-top:7px;" id="{{this.product._id}}" name="quantity"
											class="qty ">{{this.quantity}}</span>

										<button style="border: none;" class="qtyplus text-success"
											onclick="changeQuantity('{{this._id}}','{{this.product._id}}','{{../user}}',1)">+</button>
										
									</form>
								</td>

								
								<td>
									
									<button style="border:none;"
										onclick="deleteCart('{{this._id}}','{{this.product._id}}')"><img
											src="/images/trash-2-32.ico" style="width: 20px;" alt=""
											class="mCS_img_loaded "></button>
								</td>
							</tr>
							{{/each}}





						</tbody>
					</table>
					
				</div>
				<!-- /.table-cart -->
			</div>
			<!-- /.col-lg-8 -->
			<div class="col-lg-4">
				<div class="cart-totals">
					<h3>Cart Totals</h3>
					<form action="#" method="get" accept-charset="utf-8">
						<table>
							<tbody>
								<tr>
									<td>Subtotal</td>
									<td class="subtotal">&#8377;{{totalAmount}}</td>
								</tr>
								<tr style="border-bottom: 1px dotted grey;">
									<td>Shipping</td>
									<td class="free-shipping">Free Shipping</td>

								</tr>
								<tr class="total-row">
									<td>Total</td>
									<td id="total" class="price-total">&#8377;{{totalAmount}}</td>
								</tr>



							</tbody>
						</table>
						<div class="btn-cart-totals">
							<a href="/place-order" class="update round-black-btn  " title="">Proceed to Checkout</a>
							<a href="/" class="checkout round-black-btn" title="">Continue Shopping</a>
						</div>
						<!-- /.btn-cart-totals -->
					</form>
					<!-- /form -->
				</div>
				<!-- /.cart-totals -->
			</div>
			<!-- /.col-lg-4 -->
		</div>
	</div>
</div>


<script>
	function changeQuantity(cartId, proId, userId, count) {
		let quantity = parseInt(document.getElementById(proId).innerHTML)
		count = parseInt(count)

		$.ajax({
			url: '/change-product-quantity',
			data: {
				user: userId,
				cart: cartId,
				product: proId,
				count: count,
				quantity: quantity
			},
			method: 'post',
			success: (response) => {
				if (response.removeProduct) {
					/*alert('Product Remove From Cart')*/
					document.getElementById('minus-count').disabled = true;
					/*location.reload()*/
				} else {
					document.getElementById(proId).innerHTML = quantity + count
					/*document.getElementById('total').innerHTML=response.totalAmount*/
				}

			}

		})
	}
</script>


<script>
	function deleteCart(cartId, proId) {


		$.ajax({
			url: '/delete-cart-item',
			data: {
				cart: cartId,
				product: proId

			},
			method: 'post',
			success: (response) => {
				if (response.removeProduct) {
					alert('Product will Remove From The Cart Permanently')

					location.reload()
				}

			}

		})
	}
</script>